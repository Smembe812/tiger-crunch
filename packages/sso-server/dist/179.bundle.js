(()=>{var e={646:(e,t,r)=>{"use strict";class n extends Error{constructor(e){super(e),this.code=n.code,this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}n.code="ERR_JOSE_GENERIC";class o extends n{constructor(e,t="unspecified",r="unspecified"){super(e),this.code=o.code,this.claim=t,this.reason=r}}o.code="ERR_JWT_CLAIM_VALIDATION_FAILED";class a extends n{constructor(){super(...arguments),this.code=a.code}}a.code="ERR_JOSE_ALG_NOT_ALLOWED";class s extends n{constructor(){super(...arguments),this.code=s.code}}s.code="ERR_JOSE_NOT_SUPPORTED";class i extends n{constructor(){super(...arguments),this.code=i.code,this.message="decryption operation failed"}}i.code="ERR_JWE_DECRYPTION_FAILED";class c extends n{constructor(){super(...arguments),this.code=c.code}}c.code="ERR_JWE_INVALID";class d extends n{constructor(){super(...arguments),this.code=d.code}}d.code="ERR_JWS_INVALID";class l extends n{constructor(){super(...arguments),this.code=l.code}}l.code="ERR_JWT_INVALID";class u extends n{constructor(){super(...arguments),this.code=u.code}}u.code="ERR_JWK_INVALID";class p extends n{constructor(){super(...arguments),this.code=p.code}}p.code="ERR_JWKS_INVALID";class h extends n{constructor(){super(...arguments),this.code=h.code,this.message="no applicable key found in the JSON Web Key Set"}}h.code="ERR_JWKS_NO_MATCHING_KEY";class y extends n{constructor(){super(...arguments),this.code=y.code,this.message="multiple matching keys found in the JSON Web Key Set"}}y.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";class m extends n{constructor(){super(...arguments),this.code=m.code,this.message="signature verification failed"}}m.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";class f extends o{constructor(){super(...arguments),this.code=f.code}}f.code="ERR_JWT_EXPIRED";const w=new TextEncoder,g=new TextDecoder;function S(e){if("object"!=typeof(t=e)||null===t||"[object Object]"!==Object.prototype.toString.call(e))return!1;var t;if(null===Object.getPrototypeOf(e))return!0;let r=e;for(;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r}const A=(e,...t)=>{let r="Key must be ";if(t.length>2){const e=t.pop();r+=`one of type ${t.join(", ")}, or ${e}.`}else 2===t.length?r+=`one of type ${t[0]} or ${t[1]}.`:r+=`of type ${t[0]}.`;return null==e?r+=` Received ${e}`:"function"==typeof e&&e.name?r+=` Received function ${e.name}`:"object"==typeof e&&null!=e&&e.constructor&&e.constructor.name&&(r+=` Received an instance of ${e.constructor.name}`),r},b=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;throw new Error("unable to locate global object")}(),E=e=>{let t=e;t instanceof Uint8Array&&(t=g.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return new Uint8Array(b.atob(t).split("").map((e=>e.charCodeAt(0))))}catch(e){throw new TypeError("The input to be decoded is not correctly encoded.")}},v=b.crypto;const P=async(e,t,r,n)=>{const o=await function(e,t,r){if(function(e){return void 0!==b.CryptoKey&&null!=e&&e instanceof b.CryptoKey}(t))return t;if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError(A(t,"CryptoKey"));return v.subtle.importKey("raw",t,{hash:{name:`SHA-${e.substr(-3)}`},name:"HMAC"},!1,[r])}throw new TypeError(A(t,"CryptoKey","Uint8Array"))}(e,t,"verify");((e,t)=>{if(e.startsWith("HS")){const r=parseInt(e.substr(-3),10),{length:n}=t.algorithm;if("number"!=typeof n||n<r)throw new TypeError(`${e} requires symmetric keys to be ${r} bits or larger`)}if(e.startsWith("RS")||e.startsWith("PS")){const{modulusLength:r}=t.algorithm;if("number"!=typeof r||r<2048)throw new TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}})(e,o);const a=function(e){switch(e){case"HS256":return{hash:{name:"SHA-256"},name:"HMAC"};case"HS384":return{hash:{name:"SHA-384"},name:"HMAC"};case"HS512":return{hash:{name:"SHA-512"},name:"HMAC"};case"PS256":return{hash:{name:"SHA-256"},name:"RSA-PSS",saltLength:32};case"PS384":return{hash:{name:"SHA-384"},name:"RSA-PSS",saltLength:48};case"PS512":return{hash:{name:"SHA-512"},name:"RSA-PSS",saltLength:64};case"RS256":return{hash:{name:"SHA-256"},name:"RSASSA-PKCS1-v1_5"};case"RS384":return{hash:{name:"SHA-384"},name:"RSASSA-PKCS1-v1_5"};case"RS512":return{hash:{name:"SHA-512"},name:"RSASSA-PKCS1-v1_5"};case"ES256":return{hash:{name:"SHA-256"},name:"ECDSA",namedCurve:"P-256"};case"ES384":return{hash:{name:"SHA-384"},name:"ECDSA",namedCurve:"P-384"};case"ES512":return{hash:{name:"SHA-512"},name:"ECDSA",namedCurve:"P-521"};default:throw new s(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}(e);try{return await v.subtle.verify(a,o,r,n)}catch(e){return!1}},C=function(e,t,r,n,o){if(void 0!==o.crit&&void 0===n.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||void 0===n.crit)return new Set;if(!Array.isArray(n.crit)||0===n.crit.length||n.crit.some((e=>"string"!=typeof e||0===e.length)))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let a;a=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t;for(const t of n.crit){if(!a.has(t))throw new s(`Extension Header Parameter "${t}" is not recognized`);if(void 0===o[t])throw new e(`Extension Header Parameter "${t}" is missing`);if(a.get(t)&&void 0===n[t])throw new e(`Extension Header Parameter "${t}" MUST be integrity protected`)}return new Set(n.crit)}.bind(void 0,d,new Map([["b64",!0]])),R=((e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some((e=>"string"!=typeof e))))throw new TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)}).bind(void 0,"algorithms"),H=async function(e,t,r){var n;if(!S(e))throw new d("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new d('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new d("JWS Protected Header incorrect type");if(void 0===e.payload)throw new d("JWS Payload missing");if("string"!=typeof e.signature)throw new d("JWS Signature missing or incorrect type");if(void 0!==e.header&&!S(e.header))throw new d("JWS Unprotected Header incorrect type");let o={};if(e.protected){const t=E(e.protected);try{o=JSON.parse(g.decode(t))}catch(e){throw new d("JWS Protected Header is invalid")}}if(!((...e)=>{const t=e.filter(Boolean);if(0===t.length||1===t.length)return!0;let r;for(const e of t){const t=Object.keys(e);if(r&&0!==r.size)for(const e of t){if(r.has(e))return!1;r.add(e)}else r=new Set(t)}return!0})(o,e.header))throw new d("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const s={...o,...e.header};let i=!0;if(C(null==r?void 0:r.crit,o,s).has("b64")&&(i=o.b64,"boolean"!=typeof i))throw new d('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:c}=s;if("string"!=typeof c||!c)throw new d('JWS "alg" (Algorithm) Header Parameter missing or invalid');const l=r&&R(r.algorithms);if(l&&!l.has(c))throw new a('"alg" (Algorithm) Header Parameter not allowed');if(i){if("string"!=typeof e.payload)throw new d("JWS Payload must be a string")}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new d("JWS Payload must be a string or an Uint8Array instance");"function"==typeof t&&(t=await t(o,e)),((e,t,r)=>{if(!(t instanceof Uint8Array||(null==t?void 0:t.type)))throw new TypeError(A(t,"KeyObject","CryptoKey","Uint8Array"));if(e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||e.match(/^A\d{3}(?:GCM)?KW$/)){if(t instanceof Uint8Array||"secret"===t.type)return;throw new TypeError('CryptoKey or KeyObject instances for symmetric algorithms must be of type "secret"')}if(t instanceof Uint8Array)throw new TypeError(A(t,"KeyObject","CryptoKey"));if("secret"===t.type)throw new TypeError('CryptoKey or KeyObject instances for asymmetric algorithms must not be of type "secret"');if("sign"===r&&"public"===t.type)throw new TypeError('CryptoKey or KeyObject instances for asymmetric algorithm signing must be of type "private"');if("decrypt"===r&&"public"===t.type)throw new TypeError('CryptoKey or KeyObject instances for asymmetric algorithm decryption must be of type "private"')})(c,t,"verify");const u=function(...e){const t=e.reduce(((e,{length:t})=>e+t),0),r=new Uint8Array(t);let n=0;return e.forEach((e=>{r.set(e,n),n+=e.length})),r}(w.encode(null!==(n=e.protected)&&void 0!==n?n:""),w.encode("."),"string"==typeof e.payload?w.encode(e.payload):e.payload),p=E(e.signature);if(!await P(c,t,p,u))throw new m;let h;h=i?E(e.payload):"string"==typeof e.payload?w.encode(e.payload):e.payload;const y={payload:h};return void 0!==e.protected&&(y.protectedHeader=o),void 0!==e.header&&(y.unprotectedHeader=e.header),y};const K=async e=>{var t,r;const{algorithm:n,keyUsages:o}=function(e){let t,r;switch(e.kty){case"oct":switch(e.alg){case"HS256":case"HS384":case"HS512":t={name:"HMAC",hash:{name:`SHA-${e.alg.substr(-3)}`}},r=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":throw new s(`${e.alg} keys cannot be imported as CryptoKey instances`);case"A128GCM":case"A192GCM":case"A256GCM":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":t={name:"AES-GCM"},r=["encrypt","decrypt"];break;case"A128KW":case"A192KW":case"A256KW":t={name:"AES-KW"},r=["wrapKey","unwrapKey"];break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":t={name:"PBKDF2"},r=["deriveBits"];break;default:throw new s('unsupported or invalid JWK "alg" (Algorithm) Parameter value')}break;case"RSA":switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:{name:`SHA-${e.alg.substr(-3)}`}},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:{name:`SHA-${e.alg.substr(-3)}`}},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:{name:`SHA-${parseInt(e.alg.substr(-3),10)||1}`}},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new s('unsupported or invalid JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(e.alg){case"ES256":case"ES384":case"ES512":t={name:"ECDSA",namedCurve:e.crv},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new s('unsupported or invalid JWK "alg" (Algorithm) Parameter value')}break;default:throw new s('unsupported or invalid JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}(e);let a="jwk",i={...e};return delete i.alg,"PBKDF2"===n.name&&(a="raw",i=E(e.k)),v.subtle.importKey(a,i,n,null!==(t=e.ext)&&void 0!==t&&t,null!==(r=e.key_ops)&&void 0!==r?r:o)};document.getElementsByTagName("BODY")[0].innerHTML='<form class="login-form"> <div> <label for="email">Email</label> <input type="text" name="email" id="email_input"> </div> <div> <label for="pin">PIN</label> <input type="password" name="pin" id="pin_input"> </div> <div> <label for="otp">OTP</label> <input type="text" name="otp" id="otp_input"> </div> <button id="on_login">Log In</button> <span id="error"></span> </form> <script src="https://cdnjs.cloudflare.com/ajax/libs/jsrsasign/8.0.20/jsrsasign-all-min.js"><\/script> ',window.crypto||window.msCrypto;const[_,...k]=window.location.hostname.split("."),T=window.location.search,W=new URLSearchParams(T).get("cb");async function I(){const e=await async function(){try{return(await fetch("https://tiger-crunch.com:4433/jwks",{method:"GET",headers:{"Content-Type":"application/json","X-Auth-Client":"true"},mode:"cors",redirect:"follow",credentials:"include"})).json()}catch(e){throw console.log(e),e}}();return localStorage.setItem("__k",JSON.stringify(e)),e}async function O(){const e=JSON.parse(localStorage.getItem("__k")).keys[0],t=await async function(e,t,r){if(!S(e))throw new TypeError("JWK must be an object");if(t||(t=e.alg),"string"!=typeof t||!t)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');switch(e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw new TypeError('missing "k" (Key Value) Parameter value');return null!=r||(r=!0!==e.ext),r?K({...e,alg:t,ext:!1}):E(e.k);case"RSA":if(void 0!==e.oth)throw new s('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return K({...e,alg:t});default:throw new s('unsupported "kty" (Key Type) Parameter value')}}(e,"RS256"),r=document.cookie.split("__IDT=s%3A")[1],[n,o,a,i]=r.split(".");return await async function(e,t,r){if(e instanceof Uint8Array&&(e=g.decode(e)),"string"!=typeof e)throw new d("Compact JWS must be a string or Uint8Array");const{0:n,1:o,2:a,length:s}=e.split(".");if(3!==s)throw new d("Invalid Compact JWS");const i=await H({payload:o||void 0,protected:n||void 0,signature:a||void 0},t,r);return{payload:i.payload,protectedHeader:i.protectedHeader}}(`${n}.${o}.${a}`,t)}if(window.onload=async function(e){localStorage.getItem("__k")||await I()},on_login.addEventListener("click",(async function(e){e.preventDefault();const t=document.querySelector("#error"),r=document.querySelector("#email_input").value,n=document.querySelector("#pin_input").value,o={claims:{email:r,otp:document.querySelector("#otp_input").value,proposedPIN:n}};try{const e="https://tiger-crunch.com:4433/auth";let r;r=W?`${e}?cb_token=${W}`:e;const n=await async function(e,t){try{return(await fetch(e,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json","X-Auth-Client":"true"},mode:"cors",redirect:"follow",credentials:"include"})).json()}catch(e){throw console.error(e),e}}(r,o);n?.message&&(t.innerHTML=n.message),n?.redirectUri&&window.location.replace(n.redirectUri),console.log(n)}catch(e){t.innerHTML=e.message}})),window.onerror=function(e,t,r,n,o){console.log(e,t,r,n,o)},window.Worker){const e=new Worker(new URL(r.p+r.u(736),r.b));e.addEventListener("message",(e=>{console.log("Message received from worker ",e.data)})),window.addEventListener("message",(async t=>{if("https://client.tiger-crunch.com:3300"===t.origin){try{await O()}catch(e){await I(),await O()}e.postMessage("msg")}}),!1)}else console.log("Your browser doesn't support web workers.")},736:()=>{self.onmessage=async function(e){if(!self.document&&self===e.target&&"https://auth.tiger-crunch.com:3000"===e.target.origin){const[t,r,n]=e.data,o="-----BEGIN PUBLIC KEY-----\n    MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwfgC/cgSha3asB3UX5m83l7iilhKlITOWDQNlixIs5FvkBlyxqhtciUx9xcR/LyGEB/a9xh2+YoglwD76kM+bq/mGG5PI7Z9R8AhIuesgh0ubtIn4HCTJvkJHdMNSfk4HZpVw2KAn67qvcdzRnSGrkNuNeSC1jWYenc3RazGRP6mozFfinEOEdbZ7jndKo2TgoiPjaH6RXM5rebYPoHNsjL7hwY9Lv69cdjEz4Lp9JpM8yItJ4gX6NUDjTXnMS9YUiLerktGAVtM2PHdO1in5LZYP9OCR1fTGkrl1KASJHDgHwIjVgIHGQk18ccj8g0TkQPdmxmRguutd86Ew3RxAQIDAQAB\n    -----END PUBLIC KEY-----";if(o)try{const e=await function(e){const t=e.substring("-----BEGIN PUBLIC KEY-----".length,e.length-"-----END PUBLIC KEY-----".length),r=function(e){const t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0,n=e.length;t<n;t++)r[t]=e.charCodeAt(t);return t}(atob(t));return crypto.subtle.importKey("spki",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}},!1,["verify"])}(o).then((e=>!0));self.postMessage([e])}catch(e){console.error(e)}else console.log("Worker: Posting message back to main script"),postMessage("Nothing")}}}},t={};t.m=e,t.u=e=>e+".bundle.js",t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var r=t.g.document;if(!e&&r&&(r.currentScript&&(e=r.currentScript.src),!e)){var n=r.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})(),t.b=document.baseURI||self.location.href,e[736](0,{},t),e[646](0,{},t)})();